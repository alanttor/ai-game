<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒæ‰‹åŠ¿ç¬¦å·ä¸æ–‡åŒ–è¯­å¢ƒ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¤š</text></svg>">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }
        .container { display: flex; height: 100vh; }
        .left-panel {
            width: 280px;
            background: rgba(0,0,0,0.3);
            border-right: 1px solid #3a3a5a;
            display: flex;
            flex-direction: column;
        }
        .center-panel { flex: 1; display: flex; flex-direction: column; }
        .right-panel {
            width: 320px;
            background: rgba(0,0,0,0.3);
            border-left: 1px solid #3a3a5a;
            padding: 15px;
            overflow-y: auto;
        }
        .panel-title {
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid #3a3a5a;
            font-weight: bold;
            color: #ffd700;
        }
        .gesture-list { flex: 1; overflow-y: auto; padding: 10px; }
        .gesture-item {
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .gesture-item:hover { background: rgba(255,255,255,0.1); transform: translateX(5px); }
        .gesture-item.active { background: rgba(255,215,0,0.2); border: 1px solid #ffd700; }
        .gesture-icon { font-size: 2em; }
        .gesture-name { font-size: 0.95em; }
        .map-area { flex: 1; position: relative; }
        #worldMap { width: 100%; height: 100%; }
        .hand-demo {
            height: 200px;
            background: rgba(0,0,0,0.4);
            border-bottom: 1px solid #3a3a5a;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .hand-3d {
            font-size: 8em;
            transition: transform 0.5s;
        }
        .meaning-card {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .meaning-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .region-flag { font-size: 1.5em; }
        .region-name { font-weight: bold; color: #4af; }
        .meaning-text { font-size: 0.95em; line-height: 1.6; }
        .meaning-sentiment {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-top: 8px;
        }
        .positive { background: rgba(76,175,80,0.3); color: #4caf50; }
        .negative { background: rgba(244,67,54,0.3); color: #f44336; }
        .neutral { background: rgba(158,158,158,0.3); color: #9e9e9e; }
        .warning { background: rgba(255,152,0,0.3); color: #ff9800; }
        .category-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px;
            background: rgba(0,0,0,0.2);
        }
        .cat-tab {
            padding: 6px 12px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 15px;
            color: #aaa;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s;
        }
        .cat-tab:hover { background: rgba(255,255,255,0.2); }
        .cat-tab.active { background: #ffd700; color: #000; }
        .scenario-box {
            background: linear-gradient(135deg, rgba(74,144,226,0.2), rgba(80,200,120,0.2));
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }
        .scenario-title { color: #4af; font-weight: bold; margin-bottom: 10px; }
        .scenario-desc { font-size: 0.9em; color: #aaa; line-height: 1.5; }
        .quiz-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 1em;
            margin-top: 15px;
            transition: transform 0.2s;
        }
        .quiz-btn:hover { transform: scale(1.02); }
        .context-info {
            background: rgba(255,215,0,0.1);
            border-left: 3px solid #ffd700;
            padding: 10px 15px;
            margin: 15px 0;
            font-size: 0.9em;
        }
        .region-dot {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            animation: pulse 2s infinite;
        }
        .region-dot:hover { transform: scale(1.5); }
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255,215,0,0.4); }
            50% { box-shadow: 0 0 0 8px rgba(255,215,0,0); }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="left-panel">
        <div class="panel-title">ğŸ¤š æ‰‹åŠ¿åº“</div>
        <div class="category-tabs" id="categoryTabs"></div>
        <div class="gesture-list" id="gestureList"></div>
    </div>
    <div class="center-panel">
        <div class="hand-demo">
            <div class="hand-3d" id="handDemo">ğŸ‘‹</div>
        </div>
        <div class="map-area">
            <canvas id="worldMap"></canvas>
        </div>
    </div>
    <div class="right-panel">
        <div class="panel-title">ğŸ“Š æ–‡åŒ–å«ä¹‰åˆ†æ</div>
        <div id="meaningAnalysis"></div>
    </div>
</div>
<script>
const canvas = document.getElementById('worldMap');
const ctx = canvas.getContext('2d');

// æ‰‹åŠ¿æ•°æ®åº“
const gestures = {
    greeting: [
        { id: 'wave', name: 'æŒ¥æ‰‹', icon: 'ğŸ‘‹', desc: 'æ‰‹æŒå¼ å¼€å·¦å³æ‘†åŠ¨' },
        { id: 'handshake', name: 'æ¡æ‰‹', icon: 'ğŸ¤', desc: 'åŒæ–¹å³æ‰‹ç›¸æ¡' },
        { id: 'bow', name: 'é èº¬', icon: 'ğŸ™‡', desc: 'å¼¯è…°ä½å¤´è‡´æ„' },
        { id: 'namaste', name: 'åˆåç¤¼', icon: 'ğŸ™', desc: 'åŒæ‰‹åˆåäºèƒ¸å‰' }
    ],
    affirmation: [
        { id: 'thumbsup', name: 'ç«–å¤§æ‹‡æŒ‡', icon: 'ğŸ‘', desc: 'å¤§æ‹‡æŒ‡å‘ä¸Š' },
        { id: 'ok', name: 'OKæ‰‹åŠ¿', icon: 'ğŸ‘Œ', desc: 'æ‹‡æŒ‡é£ŸæŒ‡æˆåœˆ' },
        { id: 'nod', name: 'ç‚¹å¤´', icon: 'ğŸ˜Š', desc: 'å¤´éƒ¨ä¸Šä¸‹ç§»åŠ¨' },
        { id: 'vsign', name: 'Vå­—æ‰‹åŠ¿', icon: 'âœŒï¸', desc: 'é£ŸæŒ‡ä¸­æŒ‡åˆ†å¼€' }
    ],
    numbers: [
        { id: 'one', name: 'æ•°å­—1', icon: 'â˜ï¸', desc: 'é£ŸæŒ‡ä¼¸å‡º' },
        { id: 'two', name: 'æ•°å­—2', icon: 'âœŒï¸', desc: 'é£ŸæŒ‡ä¸­æŒ‡ä¼¸å‡º' },
        { id: 'five', name: 'æ•°å­—5', icon: 'ğŸ–ï¸', desc: 'äº”æŒ‡å¼ å¼€' }
    ],
    practical: [
        { id: 'point', name: 'æŒ‡å‘', icon: 'ğŸ‘‰', desc: 'é£ŸæŒ‡æŒ‡å‘ç›®æ ‡' },
        { id: 'beckoning', name: 'æ‹›æ‰‹', icon: 'ğŸ«´', desc: 'æ‰‹æŒå‘ä¸Šæ‹›æ‰‹' },
        { id: 'stop', name: 'åœæ­¢', icon: 'âœ‹', desc: 'æ‰‹æŒå‘å‰æ¨å‡º' }
    ],
    offensive: [
        { id: 'middlefinger', name: 'ç«–ä¸­æŒ‡', icon: 'ğŸ–•', desc: 'ä¸­æŒ‡å•ç‹¬ä¼¸å‡º' },
        { id: 'fist', name: 'æ¡æ‹³', icon: 'âœŠ', desc: 'äº”æŒ‡ç´§æ¡' }
    ]
};

// æ–‡åŒ–åŒºåŸŸæ•°æ®
const regions = {
    eastAsia: { name: 'ä¸œäºš', flag: 'ğŸ‡¨ğŸ‡³', x: 0.75, y: 0.35, color: '#ff6b6b' },
    southAsia: { name: 'å—äºš', flag: 'ğŸ‡®ğŸ‡³', x: 0.65, y: 0.45, color: '#ffd93d' },
    middleEast: { name: 'ä¸­ä¸œ', flag: 'ğŸ‡¸ğŸ‡¦', x: 0.55, y: 0.4, color: '#6bcb77' },
    europe: { name: 'æ¬§æ´²', flag: 'ğŸ‡ªğŸ‡º', x: 0.48, y: 0.28, color: '#4d96ff' },
    northAmerica: { name: 'åŒ—ç¾', flag: 'ğŸ‡ºğŸ‡¸', x: 0.2, y: 0.32, color: '#9b59b6' },
    latinAmerica: { name: 'æ‹‰ç¾', flag: 'ğŸ‡§ğŸ‡·', x: 0.28, y: 0.6, color: '#e74c3c' },
    africa: { name: 'éæ´²', flag: 'ğŸŒ', x: 0.5, y: 0.55, color: '#f39c12' }
};

// æ‰‹åŠ¿å«ä¹‰æ•°æ®åº“
const gestureMeanings = {
    thumbsup: {
        eastAsia: { meaning: 'å¾ˆå¥½ã€èµåŒ', sentiment: 'positive', note: 'æ™®éæ¥å—çš„ç§¯ææ‰‹åŠ¿' },
        southAsia: { meaning: 'èµåŒ', sentiment: 'positive', note: 'å¹¿æ³›ä½¿ç”¨' },
        middleEast: { meaning: 'ä¾®è¾±æ€§æ‰‹åŠ¿', sentiment: 'negative', note: 'åœ¨ä¼Šæœ—ç­‰åœ°è¢«è§†ä¸ºç²—é²' },
        europe: { meaning: 'å¾ˆå¥½ã€æ­è½¦', sentiment: 'positive', note: 'ä¹Ÿç”¨äºæ­ä¾¿è½¦' },
        northAmerica: { meaning: 'å¾ˆå¥½ã€åŒæ„', sentiment: 'positive', note: 'éå¸¸å¸¸è§çš„ç§¯ææ‰‹åŠ¿' },
        latinAmerica: { meaning: 'å¾ˆå¥½', sentiment: 'positive', note: 'æ™®éç§¯æ' },
        africa: { meaning: 'å› åœ°åŒºè€Œå¼‚', sentiment: 'neutral', note: 'è¥¿ééƒ¨åˆ†åœ°åŒºå¯èƒ½æœ‰è´Ÿé¢å«ä¹‰' }
    },
    ok: {
        eastAsia: { meaning: 'OKã€æ²¡é—®é¢˜', sentiment: 'positive', note: 'æ—¥æœ¬ä¹Ÿè¡¨ç¤ºé‡‘é’±' },
        southAsia: { meaning: 'é›¶ã€æ— ä»·å€¼', sentiment: 'neutral', note: 'å¯èƒ½è¡¨ç¤º"é›¶"' },
        middleEast: { meaning: 'ä¾®è¾±æ€§æ‰‹åŠ¿', sentiment: 'negative', note: 'è¢«è§†ä¸ºéå¸¸ç²—é²' },
        europe: { meaning: 'OKï¼ˆæ³•å›½è¡¨ç¤ºé›¶ï¼‰', sentiment: 'warning', note: 'æ³•å›½å¯èƒ½è¡¨ç¤º"é›¶"æˆ–"æ— ä»·å€¼"' },
        northAmerica: { meaning: 'OKã€å®Œç¾', sentiment: 'positive', note: 'å¹¿æ³›ä½¿ç”¨çš„ç§¯ææ‰‹åŠ¿' },
        latinAmerica: { meaning: 'ä¾®è¾±æ€§ï¼ˆå·´è¥¿ï¼‰', sentiment: 'negative', note: 'å·´è¥¿è§†ä¸ºéå¸¸ç²—é²' },
        africa: { meaning: 'å› åœ°åŒºè€Œå¼‚', sentiment: 'neutral', note: 'å«ä¹‰ä¸ä¸€' }
    },
    vsign: {
        eastAsia: { meaning: 'èƒœåˆ©ã€æ‹ç…§å§¿åŠ¿', sentiment: 'positive', note: 'éå¸¸æµè¡Œçš„æ‹ç…§æ‰‹åŠ¿' },
        southAsia: { meaning: 'èƒœåˆ©', sentiment: 'positive', note: 'å’Œå¹³æˆ–èƒœåˆ©' },
        middleEast: { meaning: 'èƒœåˆ©', sentiment: 'positive', note: 'èƒœåˆ©çš„è±¡å¾' },
        europe: { meaning: 'èƒœåˆ©/ä¾®è¾±', sentiment: 'warning', note: 'è‹±å›½æ‰‹èƒŒå‘å¤–æ˜¯ä¾®è¾±' },
        northAmerica: { meaning: 'å’Œå¹³ã€èƒœåˆ©', sentiment: 'positive', note: 'å’Œå¹³è¿åŠ¨çš„è±¡å¾' },
        latinAmerica: { meaning: 'èƒœåˆ©', sentiment: 'positive', note: 'ç§¯æå«ä¹‰' },
        africa: { meaning: 'èƒœåˆ©', sentiment: 'positive', note: 'æ™®éç§¯æ' }
    },
    wave: {
        eastAsia: { meaning: 'ä½ å¥½/å†è§', sentiment: 'positive', note: 'å‹å¥½çš„é—®å€™' },
        southAsia: { meaning: 'ä½ å¥½/å†è§', sentiment: 'positive', note: 'å‹å¥½é—®å€™' },
        middleEast: { meaning: 'ä½ å¥½/å†è§', sentiment: 'positive', note: 'å‹å¥½é—®å€™' },
        europe: { meaning: 'ä½ å¥½/å†è§', sentiment: 'positive', note: 'æ™®éå‹å¥½' },
        northAmerica: { meaning: 'ä½ å¥½/å†è§', sentiment: 'positive', note: 'éå¸¸å¸¸è§' },
        latinAmerica: { meaning: 'ä½ å¥½/å†è§', sentiment: 'positive', note: 'å‹å¥½é—®å€™' },
        africa: { meaning: 'ä½ å¥½/å†è§', sentiment: 'positive', note: 'å‹å¥½é—®å€™' }
    },
    beckoning: {
        eastAsia: { meaning: 'è¿‡æ¥ï¼ˆæ‰‹å¿ƒå‘ä¸‹ï¼‰', sentiment: 'neutral', note: 'æ‰‹å¿ƒå‘ä¸‹æ‹›æ‰‹æ˜¯æ­£ç¡®æ–¹å¼' },
        southAsia: { meaning: 'è¿‡æ¥', sentiment: 'neutral', note: 'æ‰‹å¿ƒå‘ä¸‹æ›´ç¤¼è²Œ' },
        middleEast: { meaning: 'è¿‡æ¥', sentiment: 'neutral', note: 'æ‰‹å¿ƒå‘ä¸‹' },
        europe: { meaning: 'è¿‡æ¥ï¼ˆæ‰‹å¿ƒå‘ä¸Šï¼‰', sentiment: 'positive', note: 'æ‰‹å¿ƒå‘ä¸Šæ‹›æ‰‹' },
        northAmerica: { meaning: 'è¿‡æ¥ï¼ˆæ‰‹å¿ƒå‘ä¸Šï¼‰', sentiment: 'positive', note: 'é£ŸæŒ‡å‹¾åŠ¨æˆ–æ‰‹å¿ƒå‘ä¸Š' },
        latinAmerica: { meaning: 'è¿‡æ¥', sentiment: 'neutral', note: 'æ–¹å¼å› åœ°åŒºè€Œå¼‚' },
        africa: { meaning: 'è¿‡æ¥', sentiment: 'neutral', note: 'æ–¹å¼å› åœ°åŒºè€Œå¼‚' }
    },
    point: {
        eastAsia: { meaning: 'æŒ‡å‘ï¼ˆç”¨æ‰‹æŒæ›´ç¤¼è²Œï¼‰', sentiment: 'warning', note: 'ç”¨é£ŸæŒ‡æŒ‡äººè¢«è§†ä¸ºä¸ç¤¼è²Œ' },
        southAsia: { meaning: 'æŒ‡å‘ï¼ˆé¿å…æŒ‡äººï¼‰', sentiment: 'warning', note: 'æŒ‡äººä¸ç¤¼è²Œ' },
        middleEast: { meaning: 'æŒ‡å‘', sentiment: 'warning', note: 'ç”¨é£ŸæŒ‡æŒ‡äººä¸ç¤¼è²Œ' },
        europe: { meaning: 'æŒ‡å‘', sentiment: 'neutral', note: 'ç›¸å¯¹å¯æ¥å—' },
        northAmerica: { meaning: 'æŒ‡å‘', sentiment: 'neutral', note: 'å¸¸è§ä½†æŒ‡äººæ—¶éœ€è°¨æ…' },
        latinAmerica: { meaning: 'æŒ‡å‘', sentiment: 'neutral', note: 'ç”¨å˜´å”‡æŒ‡å‘æ›´å¸¸è§' },
        africa: { meaning: 'æŒ‡å‘', sentiment: 'warning', note: 'æŸäº›åœ°åŒºç”¨é£ŸæŒ‡æŒ‡äººä¸ç¤¼è²Œ' }
    }
};

const categories = {
    greeting: 'é—®å€™',
    affirmation: 'è‚¯å®š',
    numbers: 'æ•°å­—',
    practical: 'å®ç”¨',
    offensive: 'æ•æ„Ÿ'
};

let currentCategory = 'greeting';
let currentGesture = null;

function init() {
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
    renderCategories();
    renderGestures();
    selectGesture(gestures.greeting[0]);
    animate();
}

function resizeCanvas() {
    canvas.width = canvas.parentElement.clientWidth;
    canvas.height = canvas.parentElement.clientHeight;
}

function renderCategories() {
    const tabs = document.getElementById('categoryTabs');
    tabs.innerHTML = Object.entries(categories).map(([key, name]) => `
        <button class="cat-tab ${key === currentCategory ? 'active' : ''}" 
                onclick="selectCategory('${key}')">${name}</button>
    `).join('');
}

function selectCategory(cat) {
    currentCategory = cat;
    renderCategories();
    renderGestures();
}

function renderGestures() {
    const list = document.getElementById('gestureList');
    const items = gestures[currentCategory] || [];
    list.innerHTML = items.map(g => `
        <div class="gesture-item ${currentGesture?.id === g.id ? 'active' : ''}" 
             onclick="selectGesture(${JSON.stringify(g).replace(/"/g, '&quot;')})">
            <span class="gesture-icon">${g.icon}</span>
            <div>
                <div class="gesture-name">${g.name}</div>
                <div style="font-size:0.8em;color:#888;">${g.desc}</div>
            </div>
        </div>
    `).join('');
}

function selectGesture(gesture) {
    currentGesture = gesture;
    document.getElementById('handDemo').textContent = gesture.icon;
    renderGestures();
    renderMeaningAnalysis();
}

function renderMeaningAnalysis() {
    const container = document.getElementById('meaningAnalysis');
    if (!currentGesture) {
        container.innerHTML = '<p style="color:#888;text-align:center;padding:20px;">é€‰æ‹©ä¸€ä¸ªæ‰‹åŠ¿æŸ¥çœ‹åˆ†æ</p>';
        return;
    }
    
    const meanings = gestureMeanings[currentGesture.id];
    if (!meanings) {
        container.innerHTML = `
            <div class="meaning-card">
                <h3 style="color:#ffd700;margin-bottom:10px;">${currentGesture.icon} ${currentGesture.name}</h3>
                <p style="color:#aaa;">${currentGesture.desc}</p>
                <div class="context-info">æ­¤æ‰‹åŠ¿çš„è·¨æ–‡åŒ–æ•°æ®æ­£åœ¨æ”¶é›†ä¸­...</div>
            </div>
        `;
        return;
    }
    
    let html = `
        <div class="meaning-card">
            <h3 style="color:#ffd700;margin-bottom:10px;">${currentGesture.icon} ${currentGesture.name}</h3>
            <p style="color:#aaa;margin-bottom:15px;">${currentGesture.desc}</p>
        </div>
    `;
    
    Object.entries(meanings).forEach(([regionKey, data]) => {
        const region = regions[regionKey];
        if (!region) return;
        
        html += `
            <div class="meaning-card">
                <div class="meaning-header">
                    <span class="region-flag">${region.flag}</span>
                    <span class="region-name">${region.name}</span>
                </div>
                <div class="meaning-text">${data.meaning}</div>
                <div class="meaning-sentiment ${data.sentiment}">${
                    data.sentiment === 'positive' ? 'âœ“ ç§¯æ' :
                    data.sentiment === 'negative' ? 'âœ— è´Ÿé¢/å†’çŠ¯' :
                    data.sentiment === 'warning' ? 'âš  éœ€è°¨æ…' : 'â—‹ ä¸­æ€§'
                }</div>
                <div style="font-size:0.85em;color:#888;margin-top:8px;">ğŸ’¡ ${data.note}</div>
            </div>
        `;
    });
    
    html += `
        <div class="scenario-box">
            <div class="scenario-title">ğŸ­ ä½¿ç”¨åœºæ™¯å»ºè®®</div>
            <div class="scenario-desc">
                åœ¨è·¨æ–‡åŒ–äº¤æµä¸­ä½¿ç”¨"${currentGesture.name}"æ—¶ï¼Œè¯·æ³¨æ„ç›®æ ‡æ–‡åŒ–çš„æ¥å—ç¨‹åº¦ã€‚
                å•†åŠ¡åœºåˆå»ºè®®ä¿å®ˆä½¿ç”¨ï¼Œç¤¾äº¤åœºåˆå¯æ ¹æ®å¯¹æ–¹ååº”è°ƒæ•´ã€‚
            </div>
        </div>
        <button class="quiz-btn" onclick="startQuiz()">ğŸ¯ å¼€å§‹æ–‡åŒ–æµ‹éªŒ</button>
    `;
    
    container.innerHTML = html;
}

function startQuiz() {
    const gestureKeys = Object.keys(gestureMeanings);
    const randomGesture = gestureKeys[Math.floor(Math.random() * gestureKeys.length)];
    const regionKeys = Object.keys(regions);
    const randomRegion = regionKeys[Math.floor(Math.random() * regionKeys.length)];
    
    const meaning = gestureMeanings[randomGesture]?.[randomRegion];
    if (meaning) {
        const allGestures = Object.values(gestures).flat();
        const gesture = allGestures.find(g => g.id === randomGesture);
        alert(`æµ‹éªŒé¢˜ç›®ï¼š\n\nåœ¨${regions[randomRegion].name}ï¼Œ"${gesture?.name || randomGesture}"æ‰‹åŠ¿çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ\n\nç­”æ¡ˆï¼š${meaning.meaning}\n\næç¤ºï¼š${meaning.note}`);
    }
}

function drawMap() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // ç»˜åˆ¶ç®€åŒ–ä¸–ç•Œåœ°å›¾èƒŒæ™¯
    ctx.fillStyle = 'rgba(30,60,90,0.3)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // ç»˜åˆ¶å¤§é™†è½®å»“ï¼ˆç®€åŒ–ï¼‰
    ctx.fillStyle = 'rgba(60,100,140,0.4)';
    ctx.strokeStyle = 'rgba(100,150,200,0.5)';
    ctx.lineWidth = 1;
    
    // åŒ—ç¾
    drawContinent([[0.1,0.2],[0.3,0.15],[0.35,0.35],[0.25,0.5],[0.1,0.45]]);
    // å—ç¾
    drawContinent([[0.2,0.52],[0.35,0.5],[0.38,0.7],[0.3,0.9],[0.2,0.75]]);
    // æ¬§æ´²
    drawContinent([[0.42,0.15],[0.55,0.18],[0.58,0.35],[0.45,0.38],[0.4,0.25]]);
    // éæ´²
    drawContinent([[0.42,0.4],[0.58,0.38],[0.6,0.7],[0.45,0.75],[0.4,0.5]]);
    // äºšæ´²
    drawContinent([[0.55,0.15],[0.9,0.2],[0.85,0.5],[0.6,0.55],[0.55,0.35]]);
    // æ¾³æ´²
    drawContinent([[0.75,0.65],[0.88,0.62],[0.9,0.78],[0.78,0.8]]);
    
    // ç»˜åˆ¶åŒºåŸŸæ ‡è®°ç‚¹
    const meanings = currentGesture ? gestureMeanings[currentGesture.id] : null;
    
    Object.entries(regions).forEach(([key, region]) => {
        const x = region.x * canvas.width;
        const y = region.y * canvas.height;
        
        let color = region.color;
        let size = 8;
        
        if (meanings && meanings[key]) {
            const sentiment = meanings[key].sentiment;
            color = sentiment === 'positive' ? '#4caf50' :
                    sentiment === 'negative' ? '#f44336' :
                    sentiment === 'warning' ? '#ff9800' : '#9e9e9e';
            size = 12;
        }
        
        // å‘å…‰æ•ˆæœ
        const gradient = ctx.createRadialGradient(x, y, 0, x, y, size * 2);
        gradient.addColorStop(0, color);
        gradient.addColorStop(1, 'transparent');
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(x, y, size * 2, 0, Math.PI * 2);
        ctx.fill();
        
        // ä¸­å¿ƒç‚¹
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();
        
        // æ ‡ç­¾
        ctx.fillStyle = '#fff';
        ctx.font = '12px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(region.flag + ' ' + region.name, x, y + size + 15);
    });
    
    // å›¾ä¾‹
    drawLegend();
}

function drawContinent(points) {
    if (points.length < 3) return;
    ctx.beginPath();
    ctx.moveTo(points[0][0] * canvas.width, points[0][1] * canvas.height);
    for (let i = 1; i < points.length; i++) {
        ctx.lineTo(points[i][0] * canvas.width, points[i][1] * canvas.height);
    }
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
}

function drawLegend() {
    const legendX = 20;
    const legendY = canvas.height - 100;
    
    ctx.fillStyle = 'rgba(0,0,0,0.5)';
    ctx.fillRect(legendX, legendY, 150, 90);
    
    ctx.font = '12px Arial';
    ctx.fillStyle = '#fff';
    ctx.fillText('å«ä¹‰å›¾ä¾‹ï¼š', legendX + 10, legendY + 20);
    
    const items = [
        { color: '#4caf50', text: 'ç§¯æ/å‹å¥½' },
        { color: '#ff9800', text: 'éœ€è°¨æ…ä½¿ç”¨' },
        { color: '#f44336', text: 'è´Ÿé¢/å†’çŠ¯' },
        { color: '#9e9e9e', text: 'ä¸­æ€§' }
    ];
    
    items.forEach((item, i) => {
        ctx.fillStyle = item.color;
        ctx.beginPath();
        ctx.arc(legendX + 20, legendY + 38 + i * 15, 5, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = '#ccc';
        ctx.fillText(item.text, legendX + 35, legendY + 42 + i * 15);
    });
}

function animate() {
    drawMap();
    requestAnimationFrame(animate);
}

init();
</script>
</body>
</html>