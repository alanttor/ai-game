import{d as B,r as v,h as m,i as F,j as a,l as e,t as n,k as b,F as c,m as P,g as M,o,n as f,u as A,G as k}from"./vue-vendor-CeuWReVY.js";import{u as I}from"./client-CIWp8brx.js";import{l as R}from"./leaderboard-CE2hxYMA.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"leaderboard-view"},G={key:0,class:"loading"},K={key:1,class:"error"},U={key:2,class:"leaderboard-container"},q={class:"leaderboard-table"},H={class:"rank-col"},J={class:"name-col"},O={class:"score-col"},Q={class:"wave-col"},W={class:"kills-col"},X={class:"time-col"},Y={class:"date-col"},Z={key:0,class:"empty-state"},ee={key:1,class:"pagination"},se=["disabled"],te={class:"page-numbers"},ae=["onClick"],oe={key:0,class:"ellipsis"},le=["disabled"],ne={class:"page-info"},re=B({__name:"LeaderboardView",setup(ce){const w=M(),S=I(),i=v(null),r=v(0),$=v(20),p=v(!1),_=v(null),g=m(()=>i.value?.content||[]),d=m(()=>i.value?.totalPages||0),y=m(()=>i.value?.first??!0),C=m(()=>i.value?.last??!0),L=t=>t.rank<=10,T=t=>{const l=Math.floor(t/3600),s=Math.floor(t%3600/60),h=t%60;return l>0?`${l}h ${s}m ${h}s`:s>0?`${s}m ${h}s`:`${h}s`},x=t=>new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),u=async()=>{p.value=!0,_.value=null;try{i.value=await R.getTopScores(r.value,$.value)}catch(t){_.value=t.response?.data?.message||"åŠ è½½æŽ’è¡Œæ¦œå¤±è´¥",console.error("Failed to fetch leaderboard:",t)}finally{p.value=!1}},D=()=>{y.value||(r.value--,u())},N=()=>{C.value||(r.value++,u())},V=t=>{t>=0&&t<d.value&&(r.value=t,u())},z=()=>{w.push("/")};return F(()=>{u()}),(t,l)=>(o(),a("div",E,[e("div",{class:"header"},[e("button",{class:"back-btn",onClick:z},"â† è¿”å›ž"),l[0]||(l[0]=e("h1",{class:"title"},"ðŸ† æŽ’è¡Œæ¦œ",-1)),l[1]||(l[1]=e("div",{class:"spacer"},null,-1))]),p.value?(o(),a("div",G,[...l[2]||(l[2]=[e("div",{class:"spinner"},null,-1),e("p",null,"åŠ è½½ä¸­...",-1)])])):_.value?(o(),a("div",K,[e("p",null,n(_.value),1),e("button",{class:"retry-btn",onClick:u},"é‡è¯•")])):(o(),a("div",U,[e("table",q,[l[3]||(l[3]=e("thead",null,[e("tr",null,[e("th",{class:"rank-col"},"æŽ’å"),e("th",{class:"name-col"},"çŽ©å®¶"),e("th",{class:"score-col"},"åˆ†æ•°"),e("th",{class:"wave-col"},"æ³¢æ¬¡"),e("th",{class:"kills-col"},"å‡»æ€"),e("th",{class:"time-col"},"æ¸¸æˆæ—¶é•¿"),e("th",{class:"date-col"},"è¾¾æˆæ—¶é—´")])],-1)),e("tbody",null,[(o(!0),a(c,null,P(g.value,s=>(o(),a("tr",{key:s.id,class:f({"top-ten":L(s),"top-three":s.rank<=3,"current-user":A(S).currentUser?.id===s.userId})},[e("td",H,[e("span",{class:f(["rank-badge",`rank-${s.rank}`])},[s.rank===1?(o(),a(c,{key:0},[k("ðŸ¥‡")],64)):s.rank===2?(o(),a(c,{key:1},[k("ðŸ¥ˆ")],64)):s.rank===3?(o(),a(c,{key:2},[k("ðŸ¥‰")],64)):(o(),a(c,{key:3},[k("#"+n(s.rank),1)],64))],2)]),e("td",J,n(s.playerName),1),e("td",O,n(s.score.toLocaleString()),1),e("td",Q,n(s.waveReached),1),e("td",W,n(s.zombiesKilled),1),e("td",X,n(T(s.playTimeSeconds)),1),e("td",Y,n(x(s.achievedAt)),1)],2))),128))])]),g.value.length===0?(o(),a("div",Z,[...l[4]||(l[4]=[e("p",null,"æš‚æ— æŽ’è¡Œæ¦œæ•°æ®",-1),e("p",{class:"hint"},"æˆä¸ºç¬¬ä¸€ä¸ªä¸Šæ¦œçš„çŽ©å®¶å§ï¼",-1)])])):b("",!0),d.value>1?(o(),a("div",ee,[e("button",{class:"page-btn",disabled:y.value,onClick:D}," â† ä¸Šä¸€é¡µ ",8,se),e("div",te,[(o(!0),a(c,null,P(Math.min(d.value,5),s=>(o(),a("button",{key:s-1,class:f(["page-num",{active:r.value===s-1}]),onClick:h=>V(s-1)},n(s),11,ae))),128)),d.value>5?(o(),a("span",oe,"...")):b("",!0)]),e("button",{class:"page-btn",disabled:C.value,onClick:N}," ä¸‹ä¸€é¡µ â†’ ",8,le)])):b("",!0),e("div",ne," ç¬¬ "+n(r.value+1)+" / "+n(d.value)+" é¡µ ",1)]))]))}}),_e=j(re,[["__scopeId","data-v-c2fa5143"]]);export{_e as default};
//# sourceMappingURL=LeaderboardView-CHhhMZMK.js.map
