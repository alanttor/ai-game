{"version":3,"file":"game-DfiOVufx.js","sources":["../../src/engine/types/index.ts","../../src/engine/serialization/GameStateSerializer.ts","../../src/stores/gameStore.ts","../../src/api/game.ts"],"sourcesContent":["/**\r\n * Core type definitions for the game engine\r\n */\r\n\r\n// Vector3 type for 3D positions and directions\r\nexport interface Vector3 {\r\n  x: number\r\n  y: number\r\n  z: number\r\n}\r\n\r\n// Euler rotation type\r\nexport interface Euler {\r\n  x: number\r\n  y: number\r\n  z: number\r\n}\r\n\r\n// Game state types\r\nexport interface GameState {\r\n  player: PlayerState\r\n  wave: WaveState\r\n  zombies: ZombieState[]\r\n  score: number\r\n  playTime: number\r\n  timestamp: number\r\n}\r\n\r\nexport interface PlayerState {\r\n  position: Vector3\r\n  rotation: Euler\r\n  health: number\r\n  stamina: number\r\n  weapons: WeaponState[]\r\n  currentWeaponIndex: number\r\n}\r\n\r\nexport interface WeaponState {\r\n  id: string\r\n  currentAmmo: number\r\n  reserveAmmo: number\r\n}\r\n\r\nexport interface WaveState {\r\n  currentWave: number\r\n  zombiesKilled: number\r\n  totalZombiesInWave: number\r\n  isPreparationPhase: boolean\r\n}\r\n\r\nexport interface ZombieState {\r\n  id: string\r\n  position: Vector3\r\n  health: number\r\n  variant: ZombieVariant\r\n  state: ZombieStateType\r\n}\r\n\r\n// Enums\r\nexport enum WeaponType {\r\n  PISTOL = 'pistol',\r\n  RIFLE = 'rifle',\r\n  SHOTGUN = 'shotgun',\r\n  MELEE = 'melee',\r\n}\r\n\r\nexport enum ZombieVariant {\r\n  WALKER = 'walker',\r\n  RUNNER = 'runner',\r\n  BRUTE = 'brute',\r\n  CRAWLER = 'crawler',\r\n}\r\n\r\nexport enum ZombieStateType {\r\n  IDLE = 'idle',\r\n  WANDERING = 'wandering',\r\n  CHASING = 'chasing',\r\n  ATTACKING = 'attacking',\r\n  DYING = 'dying',\r\n}\r\n\r\n// Event callback type\r\nexport type EventCallback = (data?: unknown) => void\r\n\r\n// Game engine events\r\nexport enum GameEvent {\r\n  GAME_START = 'game:start',\r\n  GAME_PAUSE = 'game:pause',\r\n  GAME_RESUME = 'game:resume',\r\n  GAME_STOP = 'game:stop',\r\n  GAME_OVER = 'game:over',\r\n  WAVE_START = 'wave:start',\r\n  WAVE_END = 'wave:end',\r\n  PLAYER_DAMAGE = 'player:damage',\r\n  PLAYER_DEATH = 'player:death',\r\n  ZOMBIE_SPAWN = 'zombie:spawn',\r\n  ZOMBIE_DEATH = 'zombie:death',\r\n}\r\n","/**\r\n * GameStateSerializer - Handles serialization and deserialization of game state\r\n * Requirements: 6.1, 6.2, 12.1, 12.2, 12.3, 12.5\r\n */\r\n\r\nimport type { GameState, PlayerState, WeaponState, WaveState, ZombieState, Vector3 } from '../types'\r\nimport { ZombieVariant, ZombieStateType } from '../types'\r\n\r\n/**\r\n * Error thrown when deserialization fails due to invalid JSON structure\r\n */\r\nexport class DeserializationError extends Error {\r\n  public readonly field: string\r\n  public readonly details: string\r\n\r\n  constructor(field: string, details: string) {\r\n    super(`Deserialization error at field '${field}': ${details}`)\r\n    this.name = 'DeserializationError'\r\n    this.field = field\r\n    this.details = details\r\n  }\r\n}\r\n\r\n/**\r\n * Rounds a number to 3 decimal places for Vector3 precision preservation\r\n * Requirements: 12.5\r\n */\r\nfunction roundToThreeDecimals(value: number): number {\r\n  return Math.round(value * 1000) / 1000\r\n}\r\n\r\n/**\r\n * Serializes a Vector3 with precision to 3 decimal places\r\n * Requirements: 12.5\r\n */\r\nfunction serializeVector3(vec: Vector3): Vector3 {\r\n  return {\r\n    x: roundToThreeDecimals(vec.x),\r\n    y: roundToThreeDecimals(vec.y),\r\n    z: roundToThreeDecimals(vec.z),\r\n  }\r\n}\r\n\r\n/**\r\n * Validates and deserializes a Vector3 from unknown input\r\n */\r\nfunction deserializeVector3(data: unknown, fieldPath: string): Vector3 {\r\n  if (typeof data !== 'object' || data === null) {\r\n    throw new DeserializationError(fieldPath, 'Expected an object')\r\n  }\r\n\r\n  const obj = data as Record<string, unknown>\r\n\r\n  if (typeof obj.x !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.x`, 'Expected a number')\r\n  }\r\n  if (typeof obj.y !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.y`, 'Expected a number')\r\n  }\r\n  if (typeof obj.z !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.z`, 'Expected a number')\r\n  }\r\n\r\n  return {\r\n    x: roundToThreeDecimals(obj.x),\r\n    y: roundToThreeDecimals(obj.y),\r\n    z: roundToThreeDecimals(obj.z),\r\n  }\r\n}\r\n\r\n/**\r\n * Validates and deserializes a WeaponState from unknown input\r\n */\r\nfunction deserializeWeaponState(data: unknown, fieldPath: string): WeaponState {\r\n  if (typeof data !== 'object' || data === null) {\r\n    throw new DeserializationError(fieldPath, 'Expected an object')\r\n  }\r\n\r\n  const obj = data as Record<string, unknown>\r\n\r\n  if (typeof obj.id !== 'string') {\r\n    throw new DeserializationError(`${fieldPath}.id`, 'Expected a string')\r\n  }\r\n  if (typeof obj.currentAmmo !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.currentAmmo`, 'Expected a number')\r\n  }\r\n  if (typeof obj.reserveAmmo !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.reserveAmmo`, 'Expected a number')\r\n  }\r\n\r\n  return {\r\n    id: obj.id,\r\n    currentAmmo: obj.currentAmmo,\r\n    reserveAmmo: obj.reserveAmmo,\r\n  }\r\n}\r\n\r\n/**\r\n * Validates and deserializes a PlayerState from unknown input\r\n */\r\nfunction deserializePlayerState(data: unknown, fieldPath: string): PlayerState {\r\n  if (typeof data !== 'object' || data === null) {\r\n    throw new DeserializationError(fieldPath, 'Expected an object')\r\n  }\r\n\r\n  const obj = data as Record<string, unknown>\r\n\r\n  if (typeof obj.health !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.health`, 'Expected a number')\r\n  }\r\n  if (typeof obj.stamina !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.stamina`, 'Expected a number')\r\n  }\r\n  if (typeof obj.currentWeaponIndex !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.currentWeaponIndex`, 'Expected a number')\r\n  }\r\n  if (!Array.isArray(obj.weapons)) {\r\n    throw new DeserializationError(`${fieldPath}.weapons`, 'Expected an array')\r\n  }\r\n\r\n  return {\r\n    position: deserializeVector3(obj.position, `${fieldPath}.position`),\r\n    rotation: deserializeVector3(obj.rotation, `${fieldPath}.rotation`),\r\n    health: obj.health,\r\n    stamina: obj.stamina,\r\n    weapons: obj.weapons.map((w, i) => deserializeWeaponState(w, `${fieldPath}.weapons[${i}]`)),\r\n    currentWeaponIndex: obj.currentWeaponIndex,\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Validates and deserializes a WaveState from unknown input\r\n */\r\nfunction deserializeWaveState(data: unknown, fieldPath: string): WaveState {\r\n  if (typeof data !== 'object' || data === null) {\r\n    throw new DeserializationError(fieldPath, 'Expected an object')\r\n  }\r\n\r\n  const obj = data as Record<string, unknown>\r\n\r\n  if (typeof obj.currentWave !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.currentWave`, 'Expected a number')\r\n  }\r\n  if (typeof obj.zombiesKilled !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.zombiesKilled`, 'Expected a number')\r\n  }\r\n  if (typeof obj.totalZombiesInWave !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.totalZombiesInWave`, 'Expected a number')\r\n  }\r\n  if (typeof obj.isPreparationPhase !== 'boolean') {\r\n    throw new DeserializationError(`${fieldPath}.isPreparationPhase`, 'Expected a boolean')\r\n  }\r\n\r\n  return {\r\n    currentWave: obj.currentWave,\r\n    zombiesKilled: obj.zombiesKilled,\r\n    totalZombiesInWave: obj.totalZombiesInWave,\r\n    isPreparationPhase: obj.isPreparationPhase,\r\n  }\r\n}\r\n\r\n/**\r\n * Validates that a value is a valid ZombieVariant\r\n */\r\nfunction isValidZombieVariant(value: unknown): value is ZombieVariant {\r\n  return Object.values(ZombieVariant).includes(value as ZombieVariant)\r\n}\r\n\r\n/**\r\n * Validates that a value is a valid ZombieStateType\r\n */\r\nfunction isValidZombieStateType(value: unknown): value is ZombieStateType {\r\n  return Object.values(ZombieStateType).includes(value as ZombieStateType)\r\n}\r\n\r\n/**\r\n * Validates and deserializes a ZombieState from unknown input\r\n */\r\nfunction deserializeZombieState(data: unknown, fieldPath: string): ZombieState {\r\n  if (typeof data !== 'object' || data === null) {\r\n    throw new DeserializationError(fieldPath, 'Expected an object')\r\n  }\r\n\r\n  const obj = data as Record<string, unknown>\r\n\r\n  if (typeof obj.id !== 'string') {\r\n    throw new DeserializationError(`${fieldPath}.id`, 'Expected a string')\r\n  }\r\n  if (typeof obj.health !== 'number') {\r\n    throw new DeserializationError(`${fieldPath}.health`, 'Expected a number')\r\n  }\r\n  if (!isValidZombieVariant(obj.variant)) {\r\n    throw new DeserializationError(\r\n      `${fieldPath}.variant`,\r\n      `Expected one of: ${Object.values(ZombieVariant).join(', ')}`\r\n    )\r\n  }\r\n  if (!isValidZombieStateType(obj.state)) {\r\n    throw new DeserializationError(\r\n      `${fieldPath}.state`,\r\n      `Expected one of: ${Object.values(ZombieStateType).join(', ')}`\r\n    )\r\n  }\r\n\r\n  return {\r\n    id: obj.id,\r\n    position: deserializeVector3(obj.position, `${fieldPath}.position`),\r\n    health: obj.health,\r\n    variant: obj.variant,\r\n    state: obj.state,\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * GameStateSerializer class for serializing and deserializing game state\r\n * Requirements: 6.1, 6.2, 12.1, 12.2, 12.3, 12.5\r\n */\r\nexport class GameStateSerializer {\r\n  /**\r\n   * Serializes a GameState object to JSON string\r\n   * Preserves Vector3 precision to 3 decimal places\r\n   * Requirements: 6.1, 12.1, 12.5\r\n   */\r\n  static serialize(state: GameState): string {\r\n    const serialized: GameState = {\r\n      player: {\r\n        position: serializeVector3(state.player.position),\r\n        rotation: serializeVector3(state.player.rotation),\r\n        health: state.player.health,\r\n        stamina: state.player.stamina,\r\n        weapons: state.player.weapons.map((w) => ({\r\n          id: w.id,\r\n          currentAmmo: w.currentAmmo,\r\n          reserveAmmo: w.reserveAmmo,\r\n        })),\r\n        currentWeaponIndex: state.player.currentWeaponIndex,\r\n      },\r\n      wave: {\r\n        currentWave: state.wave.currentWave,\r\n        zombiesKilled: state.wave.zombiesKilled,\r\n        totalZombiesInWave: state.wave.totalZombiesInWave,\r\n        isPreparationPhase: state.wave.isPreparationPhase,\r\n      },\r\n      zombies: state.zombies.map((z) => ({\r\n        id: z.id,\r\n        position: serializeVector3(z.position),\r\n        health: z.health,\r\n        variant: z.variant,\r\n        state: z.state,\r\n      })),\r\n      score: state.score,\r\n      playTime: state.playTime,\r\n      timestamp: state.timestamp,\r\n    }\r\n\r\n    return JSON.stringify(serialized)\r\n  }\r\n\r\n  /**\r\n   * Deserializes a JSON string to GameState object\r\n   * Validates all fields and throws DeserializationError for invalid input\r\n   * Requirements: 6.2, 12.2, 12.4\r\n   */\r\n  static deserialize(json: string): GameState {\r\n    let parsed: unknown\r\n\r\n    try {\r\n      parsed = JSON.parse(json)\r\n    } catch (e) {\r\n      throw new DeserializationError('root', 'Invalid JSON format')\r\n    }\r\n\r\n    if (typeof parsed !== 'object' || parsed === null) {\r\n      throw new DeserializationError('root', 'Expected an object')\r\n    }\r\n\r\n    const obj = parsed as Record<string, unknown>\r\n\r\n    if (typeof obj.score !== 'number') {\r\n      throw new DeserializationError('score', 'Expected a number')\r\n    }\r\n    if (typeof obj.playTime !== 'number') {\r\n      throw new DeserializationError('playTime', 'Expected a number')\r\n    }\r\n    if (typeof obj.timestamp !== 'number') {\r\n      throw new DeserializationError('timestamp', 'Expected a number')\r\n    }\r\n    if (!Array.isArray(obj.zombies)) {\r\n      throw new DeserializationError('zombies', 'Expected an array')\r\n    }\r\n\r\n    return {\r\n      player: deserializePlayerState(obj.player, 'player'),\r\n      wave: deserializeWaveState(obj.wave, 'wave'),\r\n      zombies: obj.zombies.map((z, i) => deserializeZombieState(z, `zombies[${i}]`)),\r\n      score: obj.score,\r\n      playTime: obj.playTime,\r\n      timestamp: obj.timestamp,\r\n    }\r\n  }\r\n}\r\n","import { defineStore } from 'pinia'\r\nimport type { GameState } from '../engine/types'\r\nimport { GameStateSerializer } from '../engine/serialization/GameStateSerializer'\r\n\r\n/**\r\n * Save summary returned from backend\r\n */\r\nexport interface SaveSummary {\r\n  id: number\r\n  waveReached: number\r\n  score: number\r\n  savedAt: string\r\n}\r\n\r\n/**\r\n * Save response from backend\r\n */\r\nexport interface SaveResponse {\r\n  saveId: number\r\n  success: boolean\r\n  message: string\r\n  savedAt: string\r\n}\r\n\r\n/**\r\n * Game store state interface\r\n * Requirements: 6.1, 6.2\r\n */\r\ninterface GameStoreState {\r\n  gameState: GameState | null\r\n  saves: SaveSummary[]\r\n  currentSaveId: number | null\r\n  isLoading: boolean\r\n  isSaving: boolean\r\n  error: string | null\r\n  lastSaveTime: number | null\r\n}\r\n\r\n/**\r\n * Game Pinia Store\r\n * Manages game state, serialization, and save/load operations\r\n * Requirements: 6.1, 6.2\r\n */\r\nexport const useGameStore = defineStore('game', {\r\n  state: (): GameStoreState => ({\r\n    gameState: null,\r\n    saves: [],\r\n    currentSaveId: null,\r\n    isLoading: false,\r\n    isSaving: false,\r\n    error: null,\r\n    lastSaveTime: null,\r\n  }),\r\n\r\n  getters: {\r\n    /**\r\n     * Get current wave number\r\n     */\r\n    currentWave: (state): number => state.gameState?.wave.currentWave ?? 0,\r\n\r\n    /**\r\n     * Get player health\r\n     */\r\n    playerHealth: (state): number => state.gameState?.player.health ?? 0,\r\n\r\n    /**\r\n     * Get current score\r\n     */\r\n    score: (state): number => state.gameState?.score ?? 0,\r\n\r\n    /**\r\n     * Get play time in seconds\r\n     */\r\n    playTime: (state): number => state.gameState?.playTime ?? 0,\r\n\r\n    /**\r\n     * Check if game state exists\r\n     */\r\n    hasGameState: (state): boolean => state.gameState !== null,\r\n\r\n    /**\r\n     * Check if there are any saves\r\n     */\r\n    hasSaves: (state): boolean => state.saves.length > 0,\r\n\r\n    /**\r\n     * Get serialized game state as JSON string\r\n     * Requirements: 6.1\r\n     */\r\n    serializedState: (state): string | null => {\r\n      if (!state.gameState) return null\r\n      return GameStateSerializer.serialize(state.gameState)\r\n    },\r\n  },\r\n\r\n  actions: {\r\n    /**\r\n     * Set the current game state\r\n     * Requirements: 6.1\r\n     */\r\n    setGameState(newState: GameState) {\r\n      this.gameState = newState\r\n      this.error = null\r\n    },\r\n\r\n    /**\r\n     * Update game state from serialized JSON\r\n     * Requirements: 6.2\r\n     */\r\n    setGameStateFromJson(json: string) {\r\n      try {\r\n        this.gameState = GameStateSerializer.deserialize(json)\r\n        this.error = null\r\n      } catch (e) {\r\n        const errorMessage = e instanceof Error ? e.message : 'Failed to deserialize game state'\r\n        this.error = errorMessage\r\n        throw e\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Clear the current game state\r\n     */\r\n    clearGameState() {\r\n      this.gameState = null\r\n      this.currentSaveId = null\r\n    },\r\n\r\n    /**\r\n     * Set loading state\r\n     */\r\n    setLoading(loading: boolean) {\r\n      this.isLoading = loading\r\n    },\r\n\r\n    /**\r\n     * Set saving state\r\n     */\r\n    setSaving(saving: boolean) {\r\n      this.isSaving = saving\r\n    },\r\n\r\n    /**\r\n     * Set error message\r\n     */\r\n    setError(error: string | null) {\r\n      this.error = error\r\n    },\r\n\r\n    /**\r\n     * Set the list of saves\r\n     */\r\n    setSaves(saves: SaveSummary[]) {\r\n      this.saves = saves\r\n    },\r\n\r\n    /**\r\n     * Set current save ID after successful save/load\r\n     */\r\n    setCurrentSaveId(saveId: number | null) {\r\n      this.currentSaveId = saveId\r\n    },\r\n\r\n    /**\r\n     * Update last save time\r\n     */\r\n    updateLastSaveTime() {\r\n      this.lastSaveTime = Date.now()\r\n    },\r\n\r\n    /**\r\n     * Add a new save to the list\r\n     */\r\n    addSave(save: SaveSummary) {\r\n      this.saves.unshift(save)\r\n    },\r\n\r\n    /**\r\n     * Remove a save from the list\r\n     */\r\n    removeSave(saveId: number) {\r\n      this.saves = this.saves.filter((s) => s.id !== saveId)\r\n      if (this.currentSaveId === saveId) {\r\n        this.currentSaveId = null\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Clear all store data\r\n     */\r\n    clearAll() {\r\n      this.gameState = null\r\n      this.saves = []\r\n      this.currentSaveId = null\r\n      this.isLoading = false\r\n      this.isSaving = false\r\n      this.error = null\r\n      this.lastSaveTime = null\r\n    },\r\n  },\r\n})\r\n","import apiClient from './client'\r\nimport type { GameState } from '@engine/types'\r\nimport type { SaveSummary, SaveResponse } from '@/stores/gameStore'\r\n\r\n/**\r\n * Game state DTO matching backend structure\r\n */\r\ninterface GameStateDTO {\r\n  player: {\r\n    position: { x: number; y: number; z: number }\r\n    rotation: { x: number; y: number; z: number }\r\n    health: number\r\n    stamina: number\r\n    weapons: Array<{\r\n      id: string\r\n      currentAmmo: number\r\n      reserveAmmo: number\r\n    }>\r\n    currentWeaponIndex: number\r\n  }\r\n  wave: {\r\n    currentWave: number\r\n    zombiesKilled: number\r\n    totalZombiesInWave: number\r\n    isPreparationPhase: boolean\r\n  }\r\n  zombies: Array<{\r\n    id: string\r\n    position: { x: number; y: number; z: number }\r\n    health: number\r\n    variant: string\r\n    state: string\r\n  }>\r\n  score: number\r\n  playTime: number\r\n  timestamp: number\r\n}\r\n\r\n/**\r\n * Convert frontend GameState to backend DTO format\r\n */\r\nfunction toGameStateDTO(state: GameState): GameStateDTO {\r\n  return {\r\n    player: {\r\n      position: { x: state.player.position.x, y: state.player.position.y, z: state.player.position.z },\r\n      rotation: { x: state.player.rotation.x, y: state.player.rotation.y, z: state.player.rotation.z },\r\n      health: state.player.health,\r\n      stamina: state.player.stamina,\r\n      weapons: state.player.weapons.map(w => ({\r\n        id: w.id,\r\n        currentAmmo: w.currentAmmo,\r\n        reserveAmmo: w.reserveAmmo,\r\n      })),\r\n      currentWeaponIndex: state.player.currentWeaponIndex,\r\n    },\r\n    wave: {\r\n      currentWave: state.wave.currentWave,\r\n      zombiesKilled: state.wave.zombiesKilled,\r\n      totalZombiesInWave: state.wave.totalZombiesInWave,\r\n      isPreparationPhase: state.wave.isPreparationPhase,\r\n    },\r\n    zombies: state.zombies.map(z => ({\r\n      id: z.id,\r\n      position: { x: z.position.x, y: z.position.y, z: z.position.z },\r\n      health: z.health,\r\n      variant: z.variant,\r\n      state: z.state,\r\n    })),\r\n    score: state.score,\r\n    playTime: state.playTime,\r\n    timestamp: state.timestamp,\r\n  }\r\n}\r\n\r\n/**\r\n * Game API endpoints for save/load operations\r\n * Requirements: 6.3, 6.5, 11.1, 11.2\r\n */\r\nexport const gameApi = {\r\n  /**\r\n   * Save the current game state to backend\r\n   * Requirements: 6.3, 11.1\r\n   * \r\n   * @param gameState - The current game state to save\r\n   * @returns SaveResponse with save ID and status\r\n   * @throws Error if save operation fails (Requirement 6.5)\r\n   */\r\n  async saveGame(gameState: GameState): Promise<SaveResponse> {\r\n    try {\r\n      const dto = toGameStateDTO(gameState)\r\n      const response = await apiClient.post<SaveResponse>('/game/save', dto)\r\n      return response.data\r\n    } catch (error) {\r\n      // Requirement 6.5: Display error message and retain current game state\r\n      const message = error instanceof Error ? error.message : 'Failed to save game'\r\n      throw new Error(`Save failed: ${message}`)\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Load a saved game state from backend\r\n   * Requirements: 6.3, 11.2\r\n   * \r\n   * @param saveId - The ID of the save to load\r\n   * @returns The loaded GameState\r\n   * @throws Error if load operation fails\r\n   */\r\n  async loadGame(saveId: number): Promise<GameState> {\r\n    try {\r\n      const response = await apiClient.get<GameStateDTO>(`/game/load/${saveId}`)\r\n      const dto = response.data\r\n      \r\n      // Convert DTO back to GameState\r\n      return {\r\n        player: {\r\n          position: dto.player.position,\r\n          rotation: dto.player.rotation,\r\n          health: dto.player.health,\r\n          stamina: dto.player.stamina,\r\n          weapons: dto.player.weapons,\r\n          currentWeaponIndex: dto.player.currentWeaponIndex,\r\n        },\r\n        wave: dto.wave,\r\n        zombies: dto.zombies.map(z => ({\r\n          id: z.id,\r\n          position: z.position,\r\n          health: z.health,\r\n          variant: z.variant as GameState['zombies'][0]['variant'],\r\n          state: z.state as GameState['zombies'][0]['state'],\r\n        })),\r\n        score: dto.score,\r\n        playTime: dto.playTime,\r\n        timestamp: dto.timestamp,\r\n      }\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to load game'\r\n      throw new Error(`Load failed: ${message}`)\r\n    }\r\n  },\r\n\r\n  /**\r\n   * List all saved games for the authenticated user\r\n   * Requirements: 11.2\r\n   * \r\n   * @returns Array of save summaries\r\n   */\r\n  async listSaves(): Promise<SaveSummary[]> {\r\n    try {\r\n      const response = await apiClient.get<SaveSummary[]>('/game/saves')\r\n      return response.data\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to list saves'\r\n      throw new Error(`List saves failed: ${message}`)\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Delete a saved game\r\n   * Requirements: 8.5\r\n   * \r\n   * @param saveId - The ID of the save to delete\r\n   */\r\n  async deleteSave(saveId: number): Promise<void> {\r\n    try {\r\n      await apiClient.delete(`/game/save/${saveId}`)\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to delete save'\r\n      throw new Error(`Delete save failed: ${message}`)\r\n    }\r\n  },\r\n}\r\n\r\nexport default gameApi\r\n"],"names":["WeaponType","ZombieVariant","ZombieStateType","GameEvent","DeserializationError","field","details","roundToThreeDecimals","value","serializeVector3","vec","deserializeVector3","data","fieldPath","obj","deserializeWeaponState","deserializePlayerState","w","deserializeWaveState","isValidZombieVariant","isValidZombieStateType","deserializeZombieState","GameStateSerializer","state","serialized","z","json","parsed","i","useGameStore","defineStore","newState","e","errorMessage","loading","saving","error","saves","saveId","save","s","toGameStateDTO","gameApi","gameState","dto","apiClient","message"],"mappings":"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"}